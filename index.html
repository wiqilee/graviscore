<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>GraviScore — Compose with Gravity</title>

  <!-- OG / Twitter -->
  <meta name="description" content="Place up to six mini planets to bend a puck’s path, strike glowing notes in order, then reach the goal. Physics into melody. By @wiqile." />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="GraviScore — Compose with Gravity" />
  <meta property="og:description" content="A musical gravity puzzler. Bend orbits, touch notes in order, reach the goal. By @wiqile." />
  <meta property="og:url" content="https://wiqilee.github.io/graviscore/" />
  <meta property="og:image" content="https://wiqilee.github.io/graviscore/icons/og.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="GraviScore — Compose with Gravity" />
  <meta name="twitter:description" content="A musical gravity puzzler. Bend orbits, touch notes in order, reach the goal. By @wiqile." />
  <meta name="twitter:image" content="https://wiqilee.github.io/graviscore/icons/og.png" />
  <meta name="theme-color" content="#0b1016" />

  <link rel="icon" href="./icons/icon-192.png" sizes="192x192" />
  <link rel="apple-touch-icon" href="./icons/icon-192.png" />
  <link rel="manifest" href="./manifest.webmanifest" crossorigin="use-credentials" />

  <style>
    :root { --bg:#0b1016; --panel:rgba(15,20,28,.94); --border:#2a3442; --ink:#cfe3ff; }
    html,body{margin:0;height:100%;background:var(--bg);color:var(--ink)}
    canvas{display:block;background:var(--bg)}

    /* Panel container (dibangun oleh main.js ke #ui-root) */
    #ui-root { position:fixed; inset:auto auto auto auto; z-index:10; }

    /* Gaya umum untuk panel (boleh dipakai main.js) */
    .panel{
      position:fixed; left:16px; top:16px; z-index:20;
      background:var(--panel); border:1px solid var(--border);
      border-radius:14px; padding:12px; max-width:640px;
      backdrop-filter:saturate(150%) blur(4px);
      box-shadow:0 6px 24px rgba(0,0,0,.35);
      color:#d7e7ff; user-select:none;
    }
    .row{display:flex;flex-wrap:wrap;gap:8px;margin:6px 0; align-items:center}
    button{
      background:#162233;color:#d7e7ff;border:1px solid #31435a;border-radius:10px;
      padding:8px 10px;cursor:pointer;font:600 12px/1 system-ui,-apple-system,Segoe UI,Roboto,Arial
    }
    button:hover{filter:brightness(1.06)}
    label{display:flex;align-items:center;gap:6px}
    .badge{background:#0f1b2a;border:1px solid #2b3b53;border-radius:10px;padding:6px 10px}
    .muted{opacity:.85}
    .right{margin-left:auto}
    .hidden{display:none}

    /* Help box */
    #helpBox{
      position:fixed; right:16px; top:16px; z-index:30;
      background:var(--panel); border:1px solid var(--border); border-radius:14px;
      max-width:420px; padding:12px; box-shadow:0 6px 24px rgba(0,0,0,.35)
    }

    /* Footer credit — nonaktifkan jika sudah digambar di canvas */
    #credit{position:fixed;left:12px;bottom:12px;color:#a5bad6;font:13px system-ui;z-index:5}
    #credit a{color:#8ac7ff}
  </style>
</head>
<body>
  <canvas id="canvas"></canvas>

  <!-- Tempat main.js membangun panel -->
  <div id="ui-root"></div>

  <!-- Help Modal -->
  <div id="helpBox" class="hidden" role="dialog" aria-modal="true" aria-label="Help">
    <div class="row" style="justify-content:space-between">
      <strong>How to play</strong>
      <button id="btnHelpClose" aria-label="Close help">✕</button>
    </div>
    <ol class="muted" style="margin:6px 0 0 20px">
      <li>Place up to six planets (left-click). Right-click removes the nearest planet.</li>
      <li>Press <b>Launch</b> to start the puck.</li>
      <li>Touch the glowing notes <b>in order</b> to unlock the goal.</li>
      <li>Reach the goal to finish and score.</li>
      <li>Enable <b>Edit Mode</b> to drag notes and the goal; the layout is saved in the Share link.</li>
      <li><b>Daily</b> seed gives everyone the same level for today.</li>
    </ol>
  </div>

  <!-- Footer (hapus jika kredit juga digambar di canvas untuk menghindari dobel) -->
  <!-- <div id="credit">GraviScore — by <a href="https://github.com/wiqile" target="_blank" rel="noopener">@wiqile</a></div> -->

  <!-- Tiny helper supaya tombol Help di panel (yang dibuat main.js) bisa membuka modal ini,
       tanpa perlu ngedit main.js. -->
  <script>
  (() => {
    const help = document.getElementById('helpBox');
    const showHelp = () => help.classList.remove('hidden');
    const hideHelp = () => help.classList.add('hidden');
    document.getElementById('btnHelpClose').addEventListener('click', hideHelp);

    // Jika main.js membuat tombol dengan id="btn-help", sambungkan otomatis.
    const mo = new MutationObserver(() => {
      const btn = document.getElementById('btn-help') || document.querySelector('[data-role="help"]');
      if (btn) { btn.addEventListener('click', showHelp, { once:false }); mo.disconnect(); }
    });
    mo.observe(document.documentElement, { childList:true, subtree:true });

    // Ekspor global opsional (kalau mau dipanggil dari main.js)
    window.GraviScoreHelp = { show: showHelp, hide: hideHelp };
  })();
  </script>

  <!-- Load order matters -->
  <script src="./leaderboard.js?v=10" defer></script>
  <script src="./worker-path-fix.js?v=10" defer></script>
  <script src="./main.js?v=13" defer></script>
</body>
</html>
